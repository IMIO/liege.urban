# -*- coding: utf-8 -*-

schedule_config = {
    'survey_schedule': [
        {
            'type_name': 'TaskConfig',
            'id': "check_address",
            'title': "Vérifier l'adresse",
            'default_assigned_user': 'survivor',
            'creation_state': 'validating_address',
            'starting_states': ('validating_address',),
            'ending_states': ('waiting_address', 'procedure_choice'),
            'start_date': 'urban.schedule.start_date.deposit_date',
            'additional_delay': 1,
        },
        {
            'type_name': 'TaskConfig',
            'id': "assign_temporary_address",
            'title': "Assigner une adresse temporaire",
            'default_assigned_user': 'survivor',
            'creation_state': 'waiting_address',
            'starting_states': ('waiting_address',),
            'ending_states': ('procedure_choice',),
            'start_date': 'urban.schedule.start_date.deposit_date',
            'additional_delay': 1,
        },
    ],
    'opinions_schedule': [
        {
            'type_name': 'TaskConfig',
            'id': "ask_road_opinion",
            'title': "Avis voirie",
            'default_assigned_group': 'Voirie_editors',
            'default_assigned_user': 'road_editor',
            'creation_state': 'creation',
            'creation_conditions': ('liege.schedule.is_internal_opinion',),
            'starting_states': ('waiting_opinion',),
            'ending_states': ('opinions_given',),
            'start_date': 'liege.urban.schedule.asking_date',
            'additional_delay': 15,
        },
        {
            'type_name': 'TaskConfig',
            'id': "ask_sssp_opinion",
            'title': "Avis SSSP",
            'default_assigned_group': 'SSSP_editors',
            'default_assigned_user': 'sssp_editor',
            'creation_state': 'creation',
            'creation_conditions': ('liege.schedule.is_internal_opinion',),
            'starting_states': ('waiting_opinion',),
            'ending_states': ('opinions_given',),
            'start_date': 'liege.urban.asking_date',
            'additional_delay': 15,
        },
    ],
    'buildlicence': [
        {
            'type_name': 'TaskConfig',
            'id': "depot",
            'title': 'Dépôt dossiers',
            'default_assigned_user': 'schedule.assign_current_user',
            'creation_state': 'deposit',
            'starting_states': ('deposit',),
            'ending_states': ('validating_address',),
            'end_conditions': ('urban.schedule.condition.deposit_done',),
            'start_date': 'urban.schedule.start_date.creation_date',
            'additional_delay': 0,
        },
        {
            'type_name': 'TaskConfig',
            'id': "choix",
            'title': 'Choix de la procédure',
            'default_assigned_user': 'teckel',
            'creation_state': 'complete',
            'starting_states': ('complete',),
            'ending_states': ('analysis',),
            'start_date': 'urban.schedule.start_date.deposit_date',
            'additional_delay': 1,
        },
        {
            'type_name': 'TaskConfig',
            'id': "accuse",
            'title': 'Accusé de réception',
            'default_assigned_user': 'schedule.assign_current_user',
            'creation_state': 'complete',
            'starting_states': ('procedure_validated', 'analysis'),
            'end_conditions': ('urban.schedule.condition.acknowledgment_done',),
            'start_date': 'urban.schedule.start_date.deposit_date',
            'additional_delay': 15,
        },
        {
            'type_name': 'MacroTaskConfig',
            'id': "analyse",
            'title': 'Dossiers à analyser',
            'default_assigned_user': 'schedule.assign_current_user',
            'creation_state': 'analysis',
            'starting_state': ('analysis',),
            'ending_states': ('preparing_decision',),
            'start_date': 'schedule.start_date.subtask_highest_due_date',
            'additional_delay': 2,
            'subtasks': [
                {
                    'type_name': 'TaskConfig',
                    'id': "enquete",
                    'title': 'Enquête publique',
                    'default_assigned_user': 'schedule.assign_current_user',
                    'creation_state': 'analysis',
                    'creation_conditions': ('urban.schedule.condition.has_inquiry',),
                    'starting_states': ('analysis',),
                    'end_conditions': ('urban.schedule.condition.inquiry_done',),
                    'start_date': 'urban.schedule.start_date.acknowledgment_date',
                    'additional_delay': 20,
                },
            ],
        },
    ],
}
